apply plugin: 'java'
apply plugin: 'eclipse'
apply plugin: 'idea'
apply plugin: 'maven-publish'

group = 're.alwyn974.minecraftserverping'
version = '2.0.0'
archivesBaseName = 'MinecraftServerPing'

sourceCompatibility = 1.8
targetCompatibility = 1.8

compileJava.options.encoding = 'UTF-8'

repositories {
    mavenCentral()
}

dependencies {
    implementation 'com.google.code.gson:gson:2.8.9'
}

configurations {
    runtimeClasspath {
        canBeResolved = true
        canBeConsumed = false
        extendsFrom implementation
    }
}

jar {
    from "LICENSE"
    from "LICENSE.LESSER"

    // 使用 runtimeClasspath 配置来收集依赖项
    from {
        configurations.runtimeClasspath.collect {
            it.isDirectory() ? it : zipTree(it)
        }
    }
}


tasks.register('sourcesJar', Jar) {
    archiveClassifier = 'sources'
    from sourceSets.main.allSource
}

build.dependsOn sourcesJar

publishing {
    publications {
        maven(MavenPublication) {
            from components.java
        }
    }

    repositories {
        maven {
            url "$buildDir/repo"
        }
    }
}

